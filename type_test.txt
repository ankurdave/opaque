import org.apache.spark.sql.types._
import org.apache.spark.sql.Row
import edu.berkeley.cs.rise.opaque.implicits._

import java.math.BigDecimal


val decimal = new BigDecimal(100000.555555)


val data = Seq(
  Row(decimal, "dog"),
  Row(decimal, "cat"),
  Row(decimal, "ant"))

val schema = StructType(
  List(
    StructField("decimal", DecimalType, true),
    StructField("animal_type", StringType, true)
  )
)

val df = spark.createDataFrame(
  spark.sparkContext.parallelize(data),
  schema
)

