import org.apache.spark.sql.types._
import org.apache.spark.sql.Row
import edu.berkeley.cs.rise.opaque.implicits._


val binary_array:Array[Int] = Array(0, -128, 127, 1)

val data = Seq(
  Row(binary_array, "dog"),
  Row(binary_array, "cat"),
  Row(binary_array, "ant")
)

val schema = StructType(
  List(
    StructField("array", ArrayType(IntegerType), true),
    StructField("animal_type", StringType, true)
  )
)

val df = spark.createDataFrame(
  spark.sparkContext.parallelize(data),
  schema
)

